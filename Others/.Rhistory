+     kmeans(x = t(LapatimibTreat), centers = k)$tot.withinss
+ })
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
library(cluster)
km = kmeans(x = t(LapatimibTreat), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
topVar3 = apply(LapatimibTreat, 1, var)
summary(topVar3)
LapatimibTreat.topVar3 = LapatimibTreat[topVar3 > quantile(topVar3, probs = 0.75), ]
dim(LapatimibTreat.topVar)
cor.mat = cor(LapatimibTreat.topVar3, method = "spearman")
cor.dist = as.dist(1 - cor.mat)
cor.hc = hclust(cor.dist, method = "ward.D2")
cor.hc = as.dendrogram(cor.hc)
pca = prcomp(LapatimibTreat.topVar, center = F, scale. = F)
print(pca)
NCI_TPW_gep_treated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_treated.rds")
dat = NCI_TPW_gep_treated[, 421:474]
LapatimibTreat <- data.frame(dat)
rm(dat)
NCI_TPW_gep_untreated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_untreated.rds")
dat = NCI_TPW_gep_untreated[, 421:474]
LapatimibUnTreat <- data.frame(dat)
rm(dat)
Metadata <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_metadata.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Cellline_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/cellline_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Drug_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/drug_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
CCLE_mutations <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_mutations.rds")
CCLE_copynumber <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_copynumber.rds")
CCLE_basalexpression <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_basalexpression.rds")
NegLogGI50 <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NegLogGI50.rds")
rm(NCI_TPW_gep_treated)
rm(NCI_TPW_gep_untreated)
topVar1 = apply(LapatimibTreat, 1, var)
summary(topVar1)
topVar2 = apply(LapatimibUnTreat, 1, var)
summary(topVar2)
km = kmeans(x = t(LapatimibTreat), centers = 5, nstart = 10)
km$tot.withinss
wss = sapply(2:7, function(k) {
+     kmeans(x = t(LapatimibTreat), centers = k)$tot.withinss
+                            }
)
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
library(cluster)
km = kmeans(x = t(LapatimibTreat), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
topVar3 = apply(LapatimibTreat, 1, var)
summary(topVar3)
LapatimibTreat.topVar3 = LapatimibTreat[topVar3 > quantile(topVar3, probs = 0.75), ]
dim(LapatimibTreat.topVar3)
cor.mat = cor(LapatimibTreat.topVar3, method = "spearman")
cor.dist = as.dist(1 - cor.mat)
cor.hc = hclust(cor.dist, method = "ward.D2")
cor.hc = as.dendrogram(cor.hc)
pca = prcomp(LapatimibTreat.topVar, center = F, scale. = F)
print(pca)
NCI_TPW_gep_treated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_treated.rds")
dat = NCI_TPW_gep_treated[, 421:474]
LapatimibTreat <- data.frame(dat)
rm(dat)
NCI_TPW_gep_untreated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_untreated.rds")
dat = NCI_TPW_gep_untreated[, 421:474]
LapatimibUnTreat <- data.frame(dat)
rm(dat)
Metadata <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_metadata.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Cellline_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/cellline_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Drug_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/drug_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
CCLE_mutations <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_mutations.rds")
CCLE_copynumber <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_copynumber.rds")
CCLE_basalexpression <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_basalexpression.rds")
NegLogGI50 <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NegLogGI50.rds")
rm(NCI_TPW_gep_treated)
rm(NCI_TPW_gep_untreated)
topVar1 = apply(LapatimibTreat, 1, var)
summary(topVar1)
topVar2 = apply(LapatimibUnTreat, 1, var)
summary(topVar2)
LapatimibTreat.topVar1 = LapatimibTreat[topVar1 > quantile(topVar1, probs = 0.75), ]
km = kmeans(x = t(LapatimibTreat.topVar1), centers = 5, nstart = 10)
km$tot.withinss
wss = sapply(2:7, function(k) {
+     kmeans(x = t(LapatimibTreat.topVar1), centers = k)$tot.withinss
+                            }
)
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
library(cluster)
km = kmeans(x = t(LapatimibTreat), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
topVar3 = apply(LapatimibTreat, 1, var)
summary(topVar3)
LapatimibTreat.topVar3 = LapatimibTreat[topVar3 > quantile(topVar3, probs = 0.75), ]
dim(LapatimibTreat.topVar3)
cor.mat = cor(LapatimibTreat.topVar3, method = "spearman")
cor.dist = as.dist(1 - cor.mat)
cor.hc = hclust(cor.dist, method = "ward.D2")
cor.hc = as.dendrogram(cor.hc)
pca = prcomp(LapatimibTreat.topVar3, center = F, scale. = F)
print(pca)
NCI_TPW_gep_treated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_treated.rds")
dat = NCI_TPW_gep_treated[, 421:474]
LapatimibTreat <- data.frame(dat)
rm(dat)
NCI_TPW_gep_untreated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_untreated.rds")
dat = NCI_TPW_gep_untreated[, 421:474]
LapatimibUnTreat <- data.frame(dat)
rm(dat)
Metadata <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_metadata.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Cellline_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/cellline_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Drug_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/drug_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
CCLE_mutations <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_mutations.rds")
CCLE_copynumber <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_copynumber.rds")
CCLE_basalexpression <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_basalexpression.rds")
NegLogGI50 <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NegLogGI50.rds")
rm(NCI_TPW_gep_treated)
rm(NCI_TPW_gep_untreated)
topVar1 = apply(LapatimibTreat, 1, var)
summary(topVar1)
topVar2 = apply(LapatimibUnTreat, 1, var)
summary(topVar2)
LapatimibTreat.topVar1 = LapatimibTreat[topVar1 > quantile(topVar1, probs = 0.75), ]
km = kmeans(x = t(LapatimibTreat.topVar1), centers = 5, nstart = 10)
km$tot.withinss
wss = sapply(2:7, function(k) {
kmeans(x = t(LapatimibTreat.topVar1), centers = k)$tot.withinss})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares")
library(cluster)
km = kmeans(x = t(LapatimibTreat), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
topVar3 = apply(LapatimibTreat, 1, var)
summary(topVar3)
LapatimibTreat.topVar3 = LapatimibTreat[topVar3 > quantile(topVar3, probs = 0.75), ]
dim(LapatimibTreat.topVar3)
cor.mat = cor(LapatimibTreat.topVar3, method = "spearman")
cor.dist = as.dist(1 - cor.mat)
cor.hc = hclust(cor.dist, method = "ward.D2")
cor.hc = as.dendrogram(cor.hc)
pca = prcomp(LapatimibTreat.topVar3, center = F, scale. = F)
print(pca)
library(cluster)
library(cluster)
library(cluster)
?silhouette
topVarTreat = apply(LapatimibTreat, 1, var)
summary(topVarTreat)
topVarUnTreat = apply(LapatimibUnTreat, 1, var)
summary(topVarUnTreat)
topVarTreat75 = LapatimibTreat[topVarTreat > quantile(topVarTreat, probs = 0.75), ]
dim(topVarTreat75)
topVarTreat = apply(LapatimibTreat, 1, var)
summary(topVarTreat)
topVarUnTreat = apply(LapatimibUnTreat, 1, var)
summary(topVarUnTreat)
topVarTreat75 = LapatimibTreat[topVarTreat > quantile(topVarTreat, probs = 0.75), ]
dim(topVarTreat75)
km = kmeans(x = t(topVarTreat75), centers = 5, nstart = 10)
km$tot.withinss
wss = sapply(2:7, function(k) {
kmeans(x = t(topVarTreat75), centers = k)$tot.withinss})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares", main = "Determining the amount of clusters from Treated")
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot (s)
library("dplyr", lib.loc="D:/Programme/R/R-3.5.1/library")
topVarTreat = apply(LapatimibTreat, 1, var)
summary(topVarTreat)
topVarUnTreat = apply(LapatimibUnTreat, 1, var)
summary(topVarUnTreat)
topVarTreat75 = LapatimibTreat[topVarTreat > quantile(topVarTreat, probs = 0.75), ]
dim(topVarTreat75)
km = kmeans(x = t(topVarTreat75), centers = 5, nstart = 10)
km$tot.withinss
wss = sapply(2:7, function(k) {
kmeans(x = t(topVarTreat75), centers = k)$tot.withinss})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares", main = "Determining the amount of clusters from Treated")
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot (s)
library(cluster)
library("cluster", lib.loc="D:/Programme/R/R-3.5.1/library")
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot (s)
library("cluster", lib.loc="D:/Programme/R/R-3.5.1/library")
install.packages("cluster")
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot (s)
library("cluster", lib.loc="D:/Programme/R/R-3.5.1/library")
library("dplyr", lib.loc="D:/Programme/R/R-3.5.1/library")
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot (s)
library(dpl+)
library(dplyr)
library(cluster)
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot (s)
D = dist(t(topVarTreat75))
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
D = dist(t(topVarTreat75))
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot(s)
cor.mat = cor(topVarTreat75, method = "spearman")
cor.dist = as.dist(1 - cor.mat)
cor.hc = hclust(cor.dist, method = "ward.D2")
cor.hc = as.dendrogram(cor.hc)
plot(cor.hc, las = 2, cex.lab = 0.7)
View(LapatimibTreat)
view(topVarTreat)
view
view(pca)
View(pca)
View(pca)
view(pca)
View(pca)
view(pca)
view(pca)
library("dplyr", lib.loc="D:/Programme/R/R-3.5.1/library")
library("cluster", lib.loc="D:/Programme/R/R-3.5.1/library")
view
view(pca)
View(km)
View(km)
View(pca)
pca = prcomp(topVarTreat75, center = F, scale. = F)
plot(pca, type = "l")
View(pca)
View(pca)
View(pca)
print(pca)
topVarTreat75
View(topVarTreat75)
sum(topVarTreat75)
summary(topVarTreat75)
summary()
plot(pca$rotation[, 1], pca$rotation[, 2], col = cb[, 1], pch = 19, xlab = "PC1",
ylab = "PC2")
View(pca)
print(pca)
plot(pca$rotation[, 1], pca$rotation[, 2], col = cb[, 1], pch = 19, xlab = "PC1",
ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2])
plot(pca$rotation[, 1], pca$rotation[, 2], xlab = "PC1",
ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = cb[, 1],xlab = "PC1",
ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = [, 1],xlab = "PC1",
ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = 1[, 1],xlab = "PC1",
ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = t[, 1],xlab = "PC1",
ylab = "PC2")
rows(pca)
row.names(pca)
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"),xlab = "PC1",
ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"),xlab = "PC1", pch=19
+      ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"),xlab = "PC1", pch = 19,
+      ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"), pch = 19 ,  xlab = "PC1",
+      ylab = "PC2")
NCI_TPW_gep_treated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_treated.rds")
dat = NCI_TPW_gep_treated[, 421:474]
LapatimibTreat <- data.frame(dat)
rm(dat)
NCI_TPW_gep_untreated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_untreated.rds")
dat = NCI_TPW_gep_untreated[, 421:474]
LapatimibUnTreat <- data.frame(dat)
rm(dat)
Metadata <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_metadata.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Cellline_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/cellline_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Drug_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/drug_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
CCLE_mutations <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_mutations.rds")
CCLE_copynumber <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_copynumber.rds")
CCLE_basalexpression <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_basalexpression.rds")
NegLogGI50 <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NegLogGI50.rds")
rm(NCI_TPW_gep_treated)
rm(NCI_TPW_gep_untreated)
topVarTreat = apply(LapatimibTreat, 1, var)
summary(topVarTreat)
topVarUnTreat = apply(LapatimibUnTreat, 1, var)
summary(topVarUnTreat)
topVarTreat75 = LapatimibTreat[topVarTreat > quantile(topVarTreat, probs = 0.75), ]
dim(topVarTreat75)
km = kmeans(x = t(topVarTreat75), centers = 5, nstart = 10)
km$tot.withinss
wss = sapply(2:7, function(k) {
kmeans(x = t(topVarTreat75), centers = k)$tot.withinss})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares", main = "Determining the amount of clusters from Treated")
D = dist(t(topVarTreat75))
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot(s)
cor.mat = cor(topVarTreat75, method = "spearman")
cor.dist = as.dist(1 - cor.mat)
cor.hc = hclust(cor.dist, method = "ward.D2")
cor.hc = as.dendrogram(cor.hc)
plot(cor.hc, las = 2, cex.lab = 0.7)
pca = prcomp(topVarTreat75, center = F, scale. = F)
plot(pca, type = "l")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red") ,xlab = "PC1",
+      ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red") ,xlab = "PC1",
+      ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red") ,xlab = "PC1",
+      ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2] ,xlab = "PC1",
+      ylab = "PC2")
plot(pca$rotation[, 1], pca$rotation[, 2], xlab = "PC1",
ylab = "PC2"
)
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"), xlab = "PC1",
ylab = "PC2")
NCI_TPW_gep_treated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_treated.rds")
dat = NCI_TPW_gep_treated[, 421:474]
LapatimibTreat <- data.frame(dat)
rm(dat)
NCI_TPW_gep_untreated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_untreated.rds")
dat = NCI_TPW_gep_untreated[, 421:474]
LapatimibUnTreat <- data.frame(dat)
rm(dat)
Metadata <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_metadata.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Cellline_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/cellline_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Drug_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/drug_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
CCLE_mutations <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_mutations.rds")
CCLE_copynumber <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_copynumber.rds")
CCLE_basalexpression <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_basalexpression.rds")
NegLogGI50 <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NegLogGI50.rds")
rm(NCI_TPW_gep_treated)
rm(NCI_TPW_gep_untreated)
topVarTreat = apply(LapatimibTreat, 1, var)
summary(topVarTreat)
topVarUnTreat = apply(LapatimibUnTreat, 1, var)
summary(topVarUnTreat)
topVarTreat75 = LapatimibTreat[topVarTreat > quantile(topVarTreat, probs = 0.75), ]
dim(topVarTreat75)
km = kmeans(x = t(topVarTreat75), centers = 5, nstart = 10)
km$tot.withinss
wss = sapply(2:7, function(k) {
kmeans(x = t(topVarTreat75), centers = k)$tot.withinss})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares", main = "Determining the amount of clusters from Treated")
D = dist(t(topVarTreat75))
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot(s)
cor.mat = cor(topVarTreat75, method = "spearman")
cor.dist = as.dist(1 - cor.mat)
cor.hc = hclust(cor.dist, method = "ward.D2")
cor.hc = as.dendrogram(cor.hc)
plot(cor.hc, las = 2, cex.lab = 0.7)
pca = prcomp(topVarTreat75, center = F, scale. = F)
plot(pca, type = "l")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"), xlab = "PC1",
+      ylab = "PC2")
pca = prcomp(topVarTreat75, center = F, scale. = F)
plot(pca, type = "l")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"), xlab = "PC1",
ylab = "PC2")
NCI_TPW_gep_treated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_treated.rds")
dat = NCI_TPW_gep_treated[, 421:474]
LapatimibTreat <- data.frame(dat)
rm(dat)
NCI_TPW_gep_untreated <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_gep_untreated.rds")
dat = NCI_TPW_gep_untreated[, 421:474]
LapatimibUnTreat <- data.frame(dat)
rm(dat)
Metadata <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/NCI_TPW_metadata.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Cellline_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/cellline_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
Drug_Annotation <- read.delim("C:/Users/tobia/Desktop/Bioinfo/Daten/drug_annotation.tsv", header = TRUE, sep = "\t", stringsAsFactors = TRUE)
CCLE_mutations <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_mutations.rds")
CCLE_copynumber <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_copynumber.rds")
CCLE_basalexpression <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/CCLE_basalexpression.rds")
NegLogGI50 <- readRDS("C:/Users/tobia/Desktop/Bioinfo/Daten/NegLogGI50.rds")
rm(NCI_TPW_gep_treated)
rm(NCI_TPW_gep_untreated)
topVarTreat = apply(LapatimibTreat, 1, var)
summary(topVarTreat)
topVarUnTreat = apply(LapatimibUnTreat, 1, var)
summary(topVarUnTreat)
topVarTreat75 = LapatimibTreat[topVarTreat > quantile(topVarTreat, probs = 0.75), ]
dim(topVarTreat75)
km = kmeans(x = t(topVarTreat75), centers = 5, nstart = 10)
km$tot.withinss
wss = sapply(2:7, function(k) {
kmeans(x = t(topVarTreat75), centers = k)$tot.withinss})
plot(2:7, wss, type = "b", pch = 19, xlab = "Number of clusters K", ylab = "Total within-clusters sum of squares", main = "Determining the amount of clusters from Treated")
D = dist(t(topVarTreat75))
km = kmeans(x = t(topVarTreat75), centers = 3, nstart = 10)
s = silhouette(km$cluster, D)
plot(s)
cor.mat = cor(topVarTreat75, method = "spearman")
cor.dist = as.dist(1 - cor.mat)
cor.hc = hclust(cor.dist, method = "ward.D2")
cor.hc = as.dendrogram(cor.hc)
plot(cor.hc, las = 2, cex.lab = 0.7)
pca = prcomp(topVarTreat75, center = F, scale. = F)
plot(pca, type = "l")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"), xlab = "PC1",
ylab = "PC2")
View(Cellline_Annotation)
pca = prcomp(topVarTreat75, center = F, scale. = F)
plot(pca, type = "l")
plot(pca$rotation[, 1], pca$rotation[, 2], col = c("blue","red"), xlab = "PC1",
ylab = "PC2")
plot(pca, type = "l")
topVarTreat75
View(topVarTreat75)
View(topVarTreat75)
summary(topVarTreat)
summary(topVarTreat)
summary((topVarTreat75))
View(NegLogGI50)
View(LapatimibTreat)
View(pca)
View(topVarTreat75)
View(CCLE_copynumber)
View(CCLE_mutations)
View(CCLE_mutations)
View(cor.hc)
View(cor.mat)
View(km)
View(Drug_Annotation)
View(NegLogGI50)
View(Metadata)
View(CCLE_copynumber)
View(Drug_Annotation)
View(CCLE_copynumber)
View(CCLE_copynumber)
rownames(CCLE_basalexpression)
metad.cl <- subset(Metadata, sample %in% intersect(Metadata$sample, pca.data$sample)) ## adjust row length of metadata to pca.data
cell.split <- split(pca.data, metad.cl$cell) #create cell vector for color annotation, but actually you don't need that
plot(pca$x[,1], pca$x[,2], col = metad.cl$drug, xlab = "PC1", ylab = "PC2", main =  "Colored by drug")
plot(pca$x[,1], pca$x[,2], col = metad.cl$dose, xlab = "PC1", ylab = "PC2", main = "Colored by dose")
plot(pca$x[,1], pca$x[,2], col = metad.cl$tissue, xlab = "PC1", ylab = "PC2", main = "Colored by tissue")
pca <- prcomp(t(Fold_Change), scale = TRUE)
#transform df by function t() because prcomp expects rows to be samples, which is not the case for Fold_Change
#goal: show relation between related samples
plot(pca$x[,1], pca$x[,2])
# get name of sample with highest pc1 value
rownames(pca$x)[order(pca$x[,1], decreasing = TRUE)[1]]
pca.var <- pca$sdev^2  # sdev calculates variation each PC accounts for
pca.var.per <- round(pca.var/sum(pca.var)*100, 1)
# since percentages make more sense then normal variation values
# calculate % or variation, which is much more interesing
barplot(pca.var.per, main = "Scree plot", xlab = "Principal Components", ylab = "% variation")
plot(pca.var.per[1:10], type = "l", xlab = "Principal Components", ylab = "% variation")
plot(pca.var.per[1:8], type = "l", xlab = "Principal Components", ylab = "% variation")
plot(cumsum(pca.var.per[1:15]), type = "l", xlab = "Principal Components", ylab = "% variation")
pca.data <- data.frame(sample = rownames(pca$x),
x = pca$x[,1],
y = pca$x[,2]
)
pca.data
View(pca.data)
### cleaned up coloring
metad.cl <- subset(Metadata, sample %in% intersect(Metadata$sample, pca.data$sample)) ## adjust row length of metadata to pca.data
cell.split <- split(pca.data, metad.cl$cell) #create cell vector for color annotation, but actually you don't need that
plot(pca$x[,1], pca$x[,2], col = metad.cl$drug, xlab = "PC1", ylab = "PC2", main =  "Colored by drug")
plot(pca$x[,1], pca$x[,2], col = metad.cl$dose, xlab = "PC1", ylab = "PC2", main = "Colored by dose")
plot(pca$x[,1], pca$x[,2], col = metad.cl$tissue, xlab = "PC1", ylab = "PC2", main = "Colored by tissue")
#PCA by Eva, created: May 23rd 2019, updated: June 2nd 2019
#capplying fold change to continous variables
Fold_Change = NCI_TPW_gep_treated - NCI_TPW_gep_untreated
Treated = data.frame(NCI_TPW_gep_treated)
Untreated = data.frame(NCI_TPW_gep_untreated)
pca <- prcomp(t(Fold_Change), scale = TRUE)
#transform df by function t() because prcomp expects rows to be samples, which is not the case for Fold_Change
#goal: show relation between related samples
plot(pca$x[,1], pca$x[,2])
# get name of sample with highest pc1 value
rownames(pca$x)[order(pca$x[,1], decreasing = TRUE)[1]]
pca.var <- pca$sdev^2  # sdev calculates variation each PC accounts for
pca.var.per <- round(pca.var/sum(pca.var)*100, 1)
# since percentages make more sense then normal variation values
# calculate % or variation, which is much more interesing
barplot(pca.var.per, main = "Scree plot", xlab = "Principal Components", ylab = "% variation")
plot(pca.var.per[1:10], type = "l", xlab = "Principal Components", ylab = "% variation")
plot(pca.var.per[1:8], type = "l", xlab = "Principal Components", ylab = "% variation")
plot(cumsum(pca.var.per[1:15]), type = "l", xlab = "Principal Components", ylab = "% variation")
pca.data <- data.frame(sample = rownames(pca$x),
x = pca$x[,1],
y = pca$x[,2]
)
pca.data
View(pca.data)
## get names of top 10 genes that contribute most to pc1
loading_scores_1 <- pca$rotation[,1]
loading_scores <- pca$rotation[,1:6]
ranked_pca <- sort(loading_scores[,1], decreasing = TRUE)
View(ranked_pca)
gene_score <- abs(loading_scores_1) ## sort magnitude
mean(gene_score)
max(gene_score)
min(gene_score)
gene_score_ranked <- sort(gene_score, decreasing = TRUE)
head(gene_score_ranked)
top_10_genes <- names(gene_score_ranked[1:10])
top_10_genes # show names of top 10 genes
pca$rotation[top_10_genes,1] ##show scores and +/- sign
barplot(pca$rotation[, 1], horiz = TRUE, main = "PC1")
heatmap(var(Fold_Change))
### cleaned up coloring
metad.cl <- subset(Metadata, sample %in% intersect(Metadata$sample, pca.data$sample)) ## adjust row length of metadata to pca.data
cell.split <- split(pca.data, metad.cl$cell) #create cell vector for color annotation, but actually you don't need that
plot(pca$x[,1], pca$x[,2], col = metad.cl$drug, xlab = "PC1", ylab = "PC2", main =  "Colored by drug")
plot(pca$x[,1], pca$x[,2], col = metad.cl$dose, xlab = "PC1", ylab = "PC2", main = "Colored by dose")
plot(pca$x[,1], pca$x[,2], col = metad.cl$tissue, xlab = "PC1", ylab = "PC2", main = "Colored by tissue")
